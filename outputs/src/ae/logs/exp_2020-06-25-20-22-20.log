Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': True, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
OLD torch.Size([83154, 4, 40]) 83154
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025094808042049, metrics {'correct': 160238, 'n_samples': 166280, 'accuracy': 0.9636636997834978}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 1000, avg loss 0.050750546786934136, metrics {'correct': 161900, 'n_samples': 166280, 'accuracy': 0.9736588886216021}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1000.pth
epoch 0, batch 1500, avg loss 0.030910583890974522, metrics {'correct': 162692, 'n_samples': 166280, 'accuracy': 0.9784219388982439}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1500.pth
epoch 0, batch 2000, avg loss 0.024241787187755107, metrics {'correct': 163142, 'n_samples': 166280, 'accuracy': 0.9811282174645177}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2000.pth
epoch 0, batch 2500, avg loss 0.020985059028491376, metrics {'correct': 163546, 'n_samples': 166280, 'accuracy': 0.9835578542217945}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2500.pth
epoch 0, batch 3000, avg loss 0.018668358916416765, metrics {'correct': 163743, 'n_samples': 166280, 'accuracy': 0.9847426028385855}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3000.pth
epoch 0, batch 3500, avg loss 0.01699970774911344, metrics {'correct': 163913, 'n_samples': 166280, 'accuracy': 0.9857649747414}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3500.pth
epoch 1, batch 4000, avg loss 0.0015196939595043658, metrics {'correct': 164153, 'n_samples': 166280, 'accuracy': 0.9872083233100793}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4000.pth
epoch 1, batch 4500, avg loss 0.014539998216554523, metrics {'correct': 164401, 'n_samples': 166280, 'accuracy': 0.9886997834977147}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4500.pth
epoch 1, batch 5000, avg loss 0.013563872193917631, metrics {'correct': 164644, 'n_samples': 166280, 'accuracy': 0.9901611739235026}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5000.pth
epoch 1, batch 5500, avg loss 0.012438313445076347, metrics {'correct': 164818, 'n_samples': 166280, 'accuracy': 0.991207601635795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5500.pth
epoch 1, batch 6000, avg loss 0.011646234556101262, metrics {'correct': 165044, 'n_samples': 166280, 'accuracy': 0.9925667548713014}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6000.pth
epoch 1, batch 6500, avg loss 0.0107188331335783, metrics {'correct': 165189, 'n_samples': 166280, 'accuracy': 0.9934387779648786}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6500.pth
epoch 1, batch 7000, avg loss 0.010073321507312357, metrics {'correct': 165356, 'n_samples': 166280, 'accuracy': 0.9944431080105846}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7000.pth
epoch 1, batch 7500, avg loss 0.009298767635598778, metrics {'correct': 165475, 'n_samples': 166280, 'accuracy': 0.9951587683425547}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-3950.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': True, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
OLD torch.Size([83154, 4, 40]) 83154
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025094808042049, metrics {'correct': 160238, 'n_samples': 166280, 'accuracy': 0.9636636997834978}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 1000, avg loss 0.050750546786934136, metrics {'correct': 161900, 'n_samples': 166280, 'accuracy': 0.9736588886216021}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1000.pth
epoch 0, batch 1500, avg loss 0.030910583890974522, metrics {'correct': 162692, 'n_samples': 166280, 'accuracy': 0.9784219388982439}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1500.pth
epoch 0, batch 2000, avg loss 0.024241787187755107, metrics {'correct': 163142, 'n_samples': 166280, 'accuracy': 0.9811282174645177}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2000.pth
epoch 0, batch 2500, avg loss 0.020985059028491376, metrics {'correct': 163546, 'n_samples': 166280, 'accuracy': 0.9835578542217945}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2500.pth
epoch 0, batch 3000, avg loss 0.018668358916416765, metrics {'correct': 163743, 'n_samples': 166280, 'accuracy': 0.9847426028385855}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3000.pth
epoch 0, batch 3500, avg loss 0.01699970774911344, metrics {'correct': 163913, 'n_samples': 166280, 'accuracy': 0.9857649747414}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3500.pth
epoch 1, batch 4000, avg loss 0.0015196939595043658, metrics {'correct': 164153, 'n_samples': 166280, 'accuracy': 0.9872083233100793}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4000.pth
epoch 1, batch 4500, avg loss 0.014539998216554523, metrics {'correct': 164401, 'n_samples': 166280, 'accuracy': 0.9886997834977147}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4500.pth
epoch 1, batch 5000, avg loss 0.013563872193917631, metrics {'correct': 164644, 'n_samples': 166280, 'accuracy': 0.9901611739235026}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5000.pth
epoch 1, batch 5500, avg loss 0.012438313445076347, metrics {'correct': 164818, 'n_samples': 166280, 'accuracy': 0.991207601635795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5500.pth
epoch 1, batch 6000, avg loss 0.011646234556101262, metrics {'correct': 165044, 'n_samples': 166280, 'accuracy': 0.9925667548713014}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6000.pth
epoch 1, batch 6500, avg loss 0.0107188331335783, metrics {'correct': 165189, 'n_samples': 166280, 'accuracy': 0.9934387779648786}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6500.pth
epoch 1, batch 7000, avg loss 0.010073321507312357, metrics {'correct': 165356, 'n_samples': 166280, 'accuracy': 0.9944431080105846}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7000.pth
epoch 1, batch 7500, avg loss 0.009298767635598778, metrics {'correct': 165475, 'n_samples': 166280, 'accuracy': 0.9951587683425547}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-3950.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': True, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
OLD torch.Size([83154, 4, 40]) 83154
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025094808042049, metrics {'correct': 160238, 'n_samples': 166280, 'accuracy': 0.9636636997834978}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 1000, avg loss 0.050750546786934136, metrics {'correct': 161900, 'n_samples': 166280, 'accuracy': 0.9736588886216021}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1000.pth
epoch 0, batch 1500, avg loss 0.030910583890974522, metrics {'correct': 162692, 'n_samples': 166280, 'accuracy': 0.9784219388982439}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1500.pth
epoch 0, batch 2000, avg loss 0.024241787187755107, metrics {'correct': 163142, 'n_samples': 166280, 'accuracy': 0.9811282174645177}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2000.pth
epoch 0, batch 2500, avg loss 0.020985059028491376, metrics {'correct': 163546, 'n_samples': 166280, 'accuracy': 0.9835578542217945}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2500.pth
epoch 0, batch 3000, avg loss 0.018668358916416765, metrics {'correct': 163743, 'n_samples': 166280, 'accuracy': 0.9847426028385855}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3000.pth
epoch 0, batch 3500, avg loss 0.01699970774911344, metrics {'correct': 163913, 'n_samples': 166280, 'accuracy': 0.9857649747414}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3500.pth
epoch 1, batch 4000, avg loss 0.0015196939595043658, metrics {'correct': 164153, 'n_samples': 166280, 'accuracy': 0.9872083233100793}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4000.pth
epoch 1, batch 4500, avg loss 0.014539998216554523, metrics {'correct': 164401, 'n_samples': 166280, 'accuracy': 0.9886997834977147}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4500.pth
epoch 1, batch 5000, avg loss 0.013563872193917631, metrics {'correct': 164644, 'n_samples': 166280, 'accuracy': 0.9901611739235026}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5000.pth
epoch 1, batch 5500, avg loss 0.012438313445076347, metrics {'correct': 164818, 'n_samples': 166280, 'accuracy': 0.991207601635795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5500.pth
epoch 1, batch 6000, avg loss 0.011646234556101262, metrics {'correct': 165044, 'n_samples': 166280, 'accuracy': 0.9925667548713014}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6000.pth
epoch 1, batch 6500, avg loss 0.0107188331335783, metrics {'correct': 165189, 'n_samples': 166280, 'accuracy': 0.9934387779648786}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6500.pth
epoch 1, batch 7000, avg loss 0.010073321507312357, metrics {'correct': 165356, 'n_samples': 166280, 'accuracy': 0.9944431080105846}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7000.pth
epoch 1, batch 7500, avg loss 0.009298767635598778, metrics {'correct': 165475, 'n_samples': 166280, 'accuracy': 0.9951587683425547}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-3950.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': True, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
OLD torch.Size([83154, 4, 40]) 83154
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025094808042049, metrics {'correct': 160238, 'n_samples': 166280, 'accuracy': 0.9636636997834978}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 1000, avg loss 0.050750546786934136, metrics {'correct': 161900, 'n_samples': 166280, 'accuracy': 0.9736588886216021}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1000.pth
epoch 0, batch 1500, avg loss 0.030910583890974522, metrics {'correct': 162692, 'n_samples': 166280, 'accuracy': 0.9784219388982439}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1500.pth
epoch 0, batch 2000, avg loss 0.024241787187755107, metrics {'correct': 163142, 'n_samples': 166280, 'accuracy': 0.9811282174645177}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2000.pth
epoch 0, batch 2500, avg loss 0.020985059028491376, metrics {'correct': 163546, 'n_samples': 166280, 'accuracy': 0.9835578542217945}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2500.pth
epoch 0, batch 3000, avg loss 0.018668358916416765, metrics {'correct': 163743, 'n_samples': 166280, 'accuracy': 0.9847426028385855}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3000.pth
epoch 0, batch 3500, avg loss 0.01699970774911344, metrics {'correct': 163913, 'n_samples': 166280, 'accuracy': 0.9857649747414}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3500.pth
epoch 1, batch 4000, avg loss 0.0015196939595043658, metrics {'correct': 164153, 'n_samples': 166280, 'accuracy': 0.9872083233100793}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4000.pth
epoch 1, batch 4500, avg loss 0.014539998216554523, metrics {'correct': 164401, 'n_samples': 166280, 'accuracy': 0.9886997834977147}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4500.pth
epoch 1, batch 5000, avg loss 0.013563872193917631, metrics {'correct': 164644, 'n_samples': 166280, 'accuracy': 0.9901611739235026}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5000.pth
epoch 1, batch 5500, avg loss 0.012438313445076347, metrics {'correct': 164818, 'n_samples': 166280, 'accuracy': 0.991207601635795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5500.pth
epoch 1, batch 6000, avg loss 0.011646234556101262, metrics {'correct': 165044, 'n_samples': 166280, 'accuracy': 0.9925667548713014}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6000.pth
epoch 1, batch 6500, avg loss 0.0107188331335783, metrics {'correct': 165189, 'n_samples': 166280, 'accuracy': 0.9934387779648786}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6500.pth
epoch 1, batch 7000, avg loss 0.010073321507312357, metrics {'correct': 165356, 'n_samples': 166280, 'accuracy': 0.9944431080105846}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7000.pth
epoch 1, batch 7500, avg loss 0.009298767635598778, metrics {'correct': 165475, 'n_samples': 166280, 'accuracy': 0.9951587683425547}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-3950.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': True, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
OLD torch.Size([83154, 4, 40]) 83154
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025094808042049, metrics {'correct': 160238, 'n_samples': 166280, 'accuracy': 0.9636636997834978}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 1000, avg loss 0.050750546786934136, metrics {'correct': 161900, 'n_samples': 166280, 'accuracy': 0.9736588886216021}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1000.pth
epoch 0, batch 1500, avg loss 0.030910583890974522, metrics {'correct': 162692, 'n_samples': 166280, 'accuracy': 0.9784219388982439}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-1500.pth
epoch 0, batch 2000, avg loss 0.024241787187755107, metrics {'correct': 163142, 'n_samples': 166280, 'accuracy': 0.9811282174645177}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2000.pth
epoch 0, batch 2500, avg loss 0.020985059028491376, metrics {'correct': 163546, 'n_samples': 166280, 'accuracy': 0.9835578542217945}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-2500.pth
epoch 0, batch 3000, avg loss 0.018668358916416765, metrics {'correct': 163743, 'n_samples': 166280, 'accuracy': 0.9847426028385855}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3000.pth
epoch 0, batch 3500, avg loss 0.01699970774911344, metrics {'correct': 163913, 'n_samples': 166280, 'accuracy': 0.9857649747414}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-3500.pth
epoch 1, batch 4000, avg loss 0.0015196939595043658, metrics {'correct': 164153, 'n_samples': 166280, 'accuracy': 0.9872083233100793}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4000.pth
epoch 1, batch 4500, avg loss 0.014539998216554523, metrics {'correct': 164401, 'n_samples': 166280, 'accuracy': 0.9886997834977147}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-4500.pth
epoch 1, batch 5000, avg loss 0.013563872193917631, metrics {'correct': 164644, 'n_samples': 166280, 'accuracy': 0.9901611739235026}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5000.pth
epoch 1, batch 5500, avg loss 0.012438313445076347, metrics {'correct': 164818, 'n_samples': 166280, 'accuracy': 0.991207601635795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-5500.pth
epoch 1, batch 6000, avg loss 0.011646234556101262, metrics {'correct': 165044, 'n_samples': 166280, 'accuracy': 0.9925667548713014}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6000.pth
epoch 1, batch 6500, avg loss 0.0107188331335783, metrics {'correct': 165189, 'n_samples': 166280, 'accuracy': 0.9934387779648786}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-6500.pth
epoch 1, batch 7000, avg loss 0.010073321507312357, metrics {'correct': 165356, 'n_samples': 166280, 'accuracy': 0.9944431080105846}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7000.pth
epoch 1, batch 7500, avg loss 0.009298767635598778, metrics {'correct': 165475, 'n_samples': 166280, 'accuracy': 0.9951587683425547}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-3950.pth
Runtime:  109.17434080102248
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 8, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 8 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025811182260513, metrics {'correct': 40035, 'n_samples': 41560, 'accuracy': 0.9633060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_9at0.1_0-500.pth
epoch 1, batch 1000, avg loss 0.0008805134445428848, metrics {'correct': 40488, 'n_samples': 41560, 'accuracy': 0.9742059672762271}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1000.pth
epoch 1, batch 1500, avg loss 0.030555392667651178, metrics {'correct': 40705, 'n_samples': 41560, 'accuracy': 0.9794273339749759}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1500.pth
epoch 2, batch 2000, avg loss 0.0010994706377387047, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2000.pth
epoch 2, batch 2500, avg loss 0.02068381005525589, metrics {'correct': 40883, 'n_samples': 41560, 'accuracy': 0.9837102983638114}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2500.pth
epoch 3, batch 3000, avg loss 0.0012956217564642429, metrics {'correct': 40919, 'n_samples': 41560, 'accuracy': 0.9845765158806544}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3000.pth
epoch 3, batch 3500, avg loss 0.016765693206340075, metrics {'correct': 40977, 'n_samples': 41560, 'accuracy': 0.9859720885466795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3500.pth
epoch 4, batch 4000, avg loss 0.0013844209462404251, metrics {'correct': 40981, 'n_samples': 41560, 'accuracy': 0.9860683349374398}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4000.pth
epoch 4, batch 4500, avg loss 0.014397115625441074, metrics {'correct': 41074, 'n_samples': 41560, 'accuracy': 0.9883060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4500.pth
epoch 5, batch 5000, avg loss 0.0015216859243810177, metrics {'correct': 41138, 'n_samples': 41560, 'accuracy': 0.9898460057747834}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5000.pth
epoch 5, batch 5500, avg loss 0.012275689057074487, metrics {'correct': 41197, 'n_samples': 41560, 'accuracy': 0.9912656400384986}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5500.pth
epoch 6, batch 6000, avg loss 0.0016081117717549206, metrics {'correct': 41230, 'n_samples': 41560, 'accuracy': 0.9920596727622714}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6000.pth
epoch 6, batch 6500, avg loss 0.010632636291906238, metrics {'correct': 41314, 'n_samples': 41560, 'accuracy': 0.9940808469682387}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6500.pth
epoch 7, batch 7000, avg loss 0.0015609207525849342, metrics {'correct': 41331, 'n_samples': 41560, 'accuracy': 0.9944898941289702}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7000.pth
epoch 7, batch 7500, avg loss 0.009118848393671214, metrics {'correct': 41351, 'n_samples': 41560, 'accuracy': 0.9949711260827719}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_8-988.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 8, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 8 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025811182260513, metrics {'correct': 40035, 'n_samples': 41560, 'accuracy': 0.9633060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_9at0.1_0-500.pth
epoch 1, batch 1000, avg loss 0.0008805134445428848, metrics {'correct': 40488, 'n_samples': 41560, 'accuracy': 0.9742059672762271}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1000.pth
epoch 1, batch 1500, avg loss 0.030555392667651178, metrics {'correct': 40705, 'n_samples': 41560, 'accuracy': 0.9794273339749759}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1500.pth
epoch 2, batch 2000, avg loss 0.0010994706377387047, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2000.pth
epoch 2, batch 2500, avg loss 0.02068381005525589, metrics {'correct': 40883, 'n_samples': 41560, 'accuracy': 0.9837102983638114}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2500.pth
epoch 3, batch 3000, avg loss 0.0012956217564642429, metrics {'correct': 40919, 'n_samples': 41560, 'accuracy': 0.9845765158806544}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3000.pth
epoch 3, batch 3500, avg loss 0.016765693206340075, metrics {'correct': 40977, 'n_samples': 41560, 'accuracy': 0.9859720885466795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3500.pth
epoch 4, batch 4000, avg loss 0.0013844209462404251, metrics {'correct': 40981, 'n_samples': 41560, 'accuracy': 0.9860683349374398}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4000.pth
epoch 4, batch 4500, avg loss 0.014397115625441074, metrics {'correct': 41074, 'n_samples': 41560, 'accuracy': 0.9883060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4500.pth
epoch 5, batch 5000, avg loss 0.0015216859243810177, metrics {'correct': 41138, 'n_samples': 41560, 'accuracy': 0.9898460057747834}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5000.pth
epoch 5, batch 5500, avg loss 0.012275689057074487, metrics {'correct': 41197, 'n_samples': 41560, 'accuracy': 0.9912656400384986}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5500.pth
epoch 6, batch 6000, avg loss 0.0016081117717549206, metrics {'correct': 41230, 'n_samples': 41560, 'accuracy': 0.9920596727622714}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6000.pth
epoch 6, batch 6500, avg loss 0.010632636291906238, metrics {'correct': 41314, 'n_samples': 41560, 'accuracy': 0.9940808469682387}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6500.pth
epoch 7, batch 7000, avg loss 0.0015609207525849342, metrics {'correct': 41331, 'n_samples': 41560, 'accuracy': 0.9944898941289702}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7000.pth
epoch 7, batch 7500, avg loss 0.009118848393671214, metrics {'correct': 41351, 'n_samples': 41560, 'accuracy': 0.9949711260827719}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_8-988.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 8, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 8 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025811182260513, metrics {'correct': 40035, 'n_samples': 41560, 'accuracy': 0.9633060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_9at0.1_0-500.pth
epoch 1, batch 1000, avg loss 0.0008805134445428848, metrics {'correct': 40488, 'n_samples': 41560, 'accuracy': 0.9742059672762271}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1000.pth
epoch 1, batch 1500, avg loss 0.030555392667651178, metrics {'correct': 40705, 'n_samples': 41560, 'accuracy': 0.9794273339749759}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1500.pth
epoch 2, batch 2000, avg loss 0.0010994706377387047, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2000.pth
epoch 2, batch 2500, avg loss 0.02068381005525589, metrics {'correct': 40883, 'n_samples': 41560, 'accuracy': 0.9837102983638114}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2500.pth
epoch 3, batch 3000, avg loss 0.0012956217564642429, metrics {'correct': 40919, 'n_samples': 41560, 'accuracy': 0.9845765158806544}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3000.pth
epoch 3, batch 3500, avg loss 0.016765693206340075, metrics {'correct': 40977, 'n_samples': 41560, 'accuracy': 0.9859720885466795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3500.pth
epoch 4, batch 4000, avg loss 0.0013844209462404251, metrics {'correct': 40981, 'n_samples': 41560, 'accuracy': 0.9860683349374398}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4000.pth
epoch 4, batch 4500, avg loss 0.014397115625441074, metrics {'correct': 41074, 'n_samples': 41560, 'accuracy': 0.9883060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4500.pth
epoch 5, batch 5000, avg loss 0.0015216859243810177, metrics {'correct': 41138, 'n_samples': 41560, 'accuracy': 0.9898460057747834}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5000.pth
epoch 5, batch 5500, avg loss 0.012275689057074487, metrics {'correct': 41197, 'n_samples': 41560, 'accuracy': 0.9912656400384986}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5500.pth
epoch 6, batch 6000, avg loss 0.0016081117717549206, metrics {'correct': 41230, 'n_samples': 41560, 'accuracy': 0.9920596727622714}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6000.pth
epoch 6, batch 6500, avg loss 0.010632636291906238, metrics {'correct': 41314, 'n_samples': 41560, 'accuracy': 0.9940808469682387}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6500.pth
epoch 7, batch 7000, avg loss 0.0015609207525849342, metrics {'correct': 41331, 'n_samples': 41560, 'accuracy': 0.9944898941289702}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7000.pth
epoch 7, batch 7500, avg loss 0.009118848393671214, metrics {'correct': 41351, 'n_samples': 41560, 'accuracy': 0.9949711260827719}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_8-988.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 8, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 8 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025811182260513, metrics {'correct': 40035, 'n_samples': 41560, 'accuracy': 0.9633060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_9at0.1_0-500.pth
epoch 1, batch 1000, avg loss 0.0008805134445428848, metrics {'correct': 40488, 'n_samples': 41560, 'accuracy': 0.9742059672762271}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1000.pth
epoch 1, batch 1500, avg loss 0.030555392667651178, metrics {'correct': 40705, 'n_samples': 41560, 'accuracy': 0.9794273339749759}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1500.pth
epoch 2, batch 2000, avg loss 0.0010994706377387047, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2000.pth
epoch 2, batch 2500, avg loss 0.02068381005525589, metrics {'correct': 40883, 'n_samples': 41560, 'accuracy': 0.9837102983638114}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2500.pth
epoch 3, batch 3000, avg loss 0.0012956217564642429, metrics {'correct': 40919, 'n_samples': 41560, 'accuracy': 0.9845765158806544}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3000.pth
epoch 3, batch 3500, avg loss 0.016765693206340075, metrics {'correct': 40977, 'n_samples': 41560, 'accuracy': 0.9859720885466795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3500.pth
epoch 4, batch 4000, avg loss 0.0013844209462404251, metrics {'correct': 40981, 'n_samples': 41560, 'accuracy': 0.9860683349374398}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4000.pth
epoch 4, batch 4500, avg loss 0.014397115625441074, metrics {'correct': 41074, 'n_samples': 41560, 'accuracy': 0.9883060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4500.pth
epoch 5, batch 5000, avg loss 0.0015216859243810177, metrics {'correct': 41138, 'n_samples': 41560, 'accuracy': 0.9898460057747834}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5000.pth
epoch 5, batch 5500, avg loss 0.012275689057074487, metrics {'correct': 41197, 'n_samples': 41560, 'accuracy': 0.9912656400384986}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5500.pth
epoch 6, batch 6000, avg loss 0.0016081117717549206, metrics {'correct': 41230, 'n_samples': 41560, 'accuracy': 0.9920596727622714}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6000.pth
epoch 6, batch 6500, avg loss 0.010632636291906238, metrics {'correct': 41314, 'n_samples': 41560, 'accuracy': 0.9940808469682387}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6500.pth
epoch 7, batch 7000, avg loss 0.0015609207525849342, metrics {'correct': 41331, 'n_samples': 41560, 'accuracy': 0.9944898941289702}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7000.pth
epoch 7, batch 7500, avg loss 0.009118848393671214, metrics {'correct': 41351, 'n_samples': 41560, 'accuracy': 0.9949711260827719}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_8-988.pth
Config values:
{'name': 'TEST_use_old_dataset', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 8, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 500, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 8 epochs
Using device:
cuda
epoch 0, batch 500, avg loss 0.3025811182260513, metrics {'correct': 40035, 'n_samples': 41560, 'accuracy': 0.9633060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_9at0.1_0-500.pth
epoch 1, batch 1000, avg loss 0.0008805134445428848, metrics {'correct': 40488, 'n_samples': 41560, 'accuracy': 0.9742059672762271}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1000.pth
epoch 1, batch 1500, avg loss 0.030555392667651178, metrics {'correct': 40705, 'n_samples': 41560, 'accuracy': 0.9794273339749759}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_10at0.1_1-1500.pth
epoch 2, batch 2000, avg loss 0.0010994706377387047, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2000.pth
epoch 2, batch 2500, avg loss 0.02068381005525589, metrics {'correct': 40883, 'n_samples': 41560, 'accuracy': 0.9837102983638114}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_11at0.1_2-2500.pth
epoch 3, batch 3000, avg loss 0.0012956217564642429, metrics {'correct': 40919, 'n_samples': 41560, 'accuracy': 0.9845765158806544}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3000.pth
epoch 3, batch 3500, avg loss 0.016765693206340075, metrics {'correct': 40977, 'n_samples': 41560, 'accuracy': 0.9859720885466795}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_12at0.1_3-3500.pth
epoch 4, batch 4000, avg loss 0.0013844209462404251, metrics {'correct': 40981, 'n_samples': 41560, 'accuracy': 0.9860683349374398}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4000.pth
epoch 4, batch 4500, avg loss 0.014397115625441074, metrics {'correct': 41074, 'n_samples': 41560, 'accuracy': 0.9883060635226179}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_13at0.1_4-4500.pth
epoch 5, batch 5000, avg loss 0.0015216859243810177, metrics {'correct': 41138, 'n_samples': 41560, 'accuracy': 0.9898460057747834}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5000.pth
epoch 5, batch 5500, avg loss 0.012275689057074487, metrics {'correct': 41197, 'n_samples': 41560, 'accuracy': 0.9912656400384986}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_14at0.1_5-5500.pth
epoch 6, batch 6000, avg loss 0.0016081117717549206, metrics {'correct': 41230, 'n_samples': 41560, 'accuracy': 0.9920596727622714}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6000.pth
epoch 6, batch 6500, avg loss 0.010632636291906238, metrics {'correct': 41314, 'n_samples': 41560, 'accuracy': 0.9940808469682387}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_15at0.1_6-6500.pth
epoch 7, batch 7000, avg loss 0.0015609207525849342, metrics {'correct': 41331, 'n_samples': 41560, 'accuracy': 0.9944898941289702}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7000.pth
epoch 7, batch 7500, avg loss 0.009118848393671214, metrics {'correct': 41351, 'n_samples': 41560, 'accuracy': 0.9949711260827719}
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_7-7500.pth
Saving model to outputs/src/ae/experiment/TEST_use_old_datasetchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_16at0.1_8-988.pth
Runtime:  93.63697273499565
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Runtime:  38.75151466700481
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 24948, 'n_samples': 41560, 'accuracy': 0.6002887391722811}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 32795, 'n_samples': 41560, 'accuracy': 0.7891000962463908}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 39020, 'n_samples': 41560, 'accuracy': 0.9388835418671799}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 39845, 'n_samples': 41560, 'accuracy': 0.9587343599615015}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 40036, 'n_samples': 41560, 'accuracy': 0.963330125120308}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 40216, 'n_samples': 41560, 'accuracy': 0.9676612127045235}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 40288, 'n_samples': 41560, 'accuracy': 0.9693936477382098}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 40346, 'n_samples': 41560, 'accuracy': 0.9707892204042349}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 40403, 'n_samples': 41560, 'accuracy': 0.9721607314725698}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 40476, 'n_samples': 41560, 'accuracy': 0.9739172281039461}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 40514, 'n_samples': 41560, 'accuracy': 0.9748315688161694}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 40565, 'n_samples': 41560, 'accuracy': 0.9760587102983638}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 40588, 'n_samples': 41560, 'accuracy': 0.9766121270452358}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 40618, 'n_samples': 41560, 'accuracy': 0.9773339749759384}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 40660, 'n_samples': 41560, 'accuracy': 0.9783445620789221}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 40679, 'n_samples': 41560, 'accuracy': 0.9788017324350337}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 40707, 'n_samples': 41560, 'accuracy': 0.9794754571703561}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 40719, 'n_samples': 41560, 'accuracy': 0.9797641963426371}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 24948, 'n_samples': 41560, 'accuracy': 0.6002887391722811}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 32795, 'n_samples': 41560, 'accuracy': 0.7891000962463908}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 39020, 'n_samples': 41560, 'accuracy': 0.9388835418671799}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 39845, 'n_samples': 41560, 'accuracy': 0.9587343599615015}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 40036, 'n_samples': 41560, 'accuracy': 0.963330125120308}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 40216, 'n_samples': 41560, 'accuracy': 0.9676612127045235}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 40288, 'n_samples': 41560, 'accuracy': 0.9693936477382098}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 40346, 'n_samples': 41560, 'accuracy': 0.9707892204042349}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 40403, 'n_samples': 41560, 'accuracy': 0.9721607314725698}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 40476, 'n_samples': 41560, 'accuracy': 0.9739172281039461}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 40514, 'n_samples': 41560, 'accuracy': 0.9748315688161694}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 40565, 'n_samples': 41560, 'accuracy': 0.9760587102983638}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 40588, 'n_samples': 41560, 'accuracy': 0.9766121270452358}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 40618, 'n_samples': 41560, 'accuracy': 0.9773339749759384}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 40660, 'n_samples': 41560, 'accuracy': 0.9783445620789221}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 40679, 'n_samples': 41560, 'accuracy': 0.9788017324350337}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 40707, 'n_samples': 41560, 'accuracy': 0.9794754571703561}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 40719, 'n_samples': 41560, 'accuracy': 0.9797641963426371}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 24948, 'n_samples': 41560, 'accuracy': 0.6002887391722811}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 32795, 'n_samples': 41560, 'accuracy': 0.7891000962463908}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 39020, 'n_samples': 41560, 'accuracy': 0.9388835418671799}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 39845, 'n_samples': 41560, 'accuracy': 0.9587343599615015}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 40036, 'n_samples': 41560, 'accuracy': 0.963330125120308}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 40216, 'n_samples': 41560, 'accuracy': 0.9676612127045235}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 40288, 'n_samples': 41560, 'accuracy': 0.9693936477382098}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 40346, 'n_samples': 41560, 'accuracy': 0.9707892204042349}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 40403, 'n_samples': 41560, 'accuracy': 0.9721607314725698}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 40476, 'n_samples': 41560, 'accuracy': 0.9739172281039461}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 40514, 'n_samples': 41560, 'accuracy': 0.9748315688161694}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 40565, 'n_samples': 41560, 'accuracy': 0.9760587102983638}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 40588, 'n_samples': 41560, 'accuracy': 0.9766121270452358}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 40618, 'n_samples': 41560, 'accuracy': 0.9773339749759384}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 40660, 'n_samples': 41560, 'accuracy': 0.9783445620789221}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 40679, 'n_samples': 41560, 'accuracy': 0.9788017324350337}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 40707, 'n_samples': 41560, 'accuracy': 0.9794754571703561}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 40719, 'n_samples': 41560, 'accuracy': 0.9797641963426371}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 24948, 'n_samples': 41560, 'accuracy': 0.6002887391722811}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 32795, 'n_samples': 41560, 'accuracy': 0.7891000962463908}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 39020, 'n_samples': 41560, 'accuracy': 0.9388835418671799}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 39845, 'n_samples': 41560, 'accuracy': 0.9587343599615015}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 40036, 'n_samples': 41560, 'accuracy': 0.963330125120308}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 40216, 'n_samples': 41560, 'accuracy': 0.9676612127045235}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 40288, 'n_samples': 41560, 'accuracy': 0.9693936477382098}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 40346, 'n_samples': 41560, 'accuracy': 0.9707892204042349}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 40403, 'n_samples': 41560, 'accuracy': 0.9721607314725698}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 40476, 'n_samples': 41560, 'accuracy': 0.9739172281039461}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 40514, 'n_samples': 41560, 'accuracy': 0.9748315688161694}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 40565, 'n_samples': 41560, 'accuracy': 0.9760587102983638}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 40588, 'n_samples': 41560, 'accuracy': 0.9766121270452358}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 40618, 'n_samples': 41560, 'accuracy': 0.9773339749759384}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 40660, 'n_samples': 41560, 'accuracy': 0.9783445620789221}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 40679, 'n_samples': 41560, 'accuracy': 0.9788017324350337}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 40707, 'n_samples': 41560, 'accuracy': 0.9794754571703561}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 40719, 'n_samples': 41560, 'accuracy': 0.9797641963426371}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_as_onehot', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 24948, 'n_samples': 41560, 'accuracy': 0.6002887391722811}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 32795, 'n_samples': 41560, 'accuracy': 0.7891000962463908}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 39020, 'n_samples': 41560, 'accuracy': 0.9388835418671799}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 39845, 'n_samples': 41560, 'accuracy': 0.9587343599615015}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 40036, 'n_samples': 41560, 'accuracy': 0.963330125120308}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 40216, 'n_samples': 41560, 'accuracy': 0.9676612127045235}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 40288, 'n_samples': 41560, 'accuracy': 0.9693936477382098}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 40346, 'n_samples': 41560, 'accuracy': 0.9707892204042349}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 40403, 'n_samples': 41560, 'accuracy': 0.9721607314725698}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 40476, 'n_samples': 41560, 'accuracy': 0.9739172281039461}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 40514, 'n_samples': 41560, 'accuracy': 0.9748315688161694}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 40565, 'n_samples': 41560, 'accuracy': 0.9760587102983638}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 40588, 'n_samples': 41560, 'accuracy': 0.9766121270452358}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 40618, 'n_samples': 41560, 'accuracy': 0.9773339749759384}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 40660, 'n_samples': 41560, 'accuracy': 0.9783445620789221}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 40679, 'n_samples': 41560, 'accuracy': 0.9788017324350337}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 40707, 'n_samples': 41560, 'accuracy': 0.9794754571703561}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 40719, 'n_samples': 41560, 'accuracy': 0.9797641963426371}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 40778, 'n_samples': 41560, 'accuracy': 0.9811838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_as_onehotchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Runtime:  37.47117223899113
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Runtime:  4.041950104001444
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_as_onehot_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': True, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_as_onehot_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Runtime:  4.106659759010654
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Runtime:  38.580211900989525
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Config values:
{'name': 'TEST_get_label', 'model': 'Autoencoder', 'kernel_len': 3, 'latent_len': 6, 'seq_len': 40, 'seq_per_batch': 20, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 2, 'learn_rate': 0.1, 'input_dropout_freq': 0.0, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 1, 'pool_size': 1, 'n_conv_and_pool': 1, 'n_conv_before_pool': 1, 'n_linear': 1, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.1, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 100, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (conv0): Conv1d(4, 6, kernel_size=(3,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(6, 4, kernel_size=(3,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 2 epochs
Using device:
cuda
epoch 0, batch 100, avg loss 0.5547519484162331, metrics {'correct': 1675, 'n_samples': 41560, 'accuracy': 0.04030317613089509}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-100.pth
epoch 0, batch 200, avg loss 0.43495195388793945, metrics {'correct': 230, 'n_samples': 41560, 'accuracy': 0.005534167468719923}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-200.pth
epoch 0, batch 300, avg loss 0.2755962148308754, metrics {'correct': 387, 'n_samples': 41560, 'accuracy': 0.009311838306063523}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-300.pth
epoch 0, batch 400, avg loss 0.15375435397028922, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-400.pth
epoch 0, batch 500, avg loss 0.09416962638497353, metrics {'correct': 454, 'n_samples': 41560, 'accuracy': 0.010923965351299325}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-500.pth
epoch 0, batch 600, avg loss 0.06848042890429497, metrics {'correct': 434, 'n_samples': 41560, 'accuracy': 0.010442733397497593}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-600.pth
epoch 0, batch 700, avg loss 0.05581413682550192, metrics {'correct': 363, 'n_samples': 41560, 'accuracy': 0.008734359961501443}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-700.pth
epoch 0, batch 800, avg loss 0.04763576440513134, metrics {'correct': 324, 'n_samples': 41560, 'accuracy': 0.007795957651588066}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-800.pth
epoch 0, batch 900, avg loss 0.041587610244750974, metrics {'correct': 284, 'n_samples': 41560, 'accuracy': 0.006833493743984601}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_3at0.1_0-900.pth
epoch 1, batch 1000, avg loss 0.004480231702327728, metrics {'correct': 259, 'n_samples': 41560, 'accuracy': 0.006231953801732435}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1000.pth
epoch 1, batch 1100, avg loss 0.0347058511339128, metrics {'correct': 229, 'n_samples': 41560, 'accuracy': 0.005510105871029836}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1100.pth
epoch 1, batch 1200, avg loss 0.03221654258668423, metrics {'correct': 220, 'n_samples': 41560, 'accuracy': 0.0052935514918190565}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1200.pth
epoch 1, batch 1300, avg loss 0.02989636754617095, metrics {'correct': 210, 'n_samples': 41560, 'accuracy': 0.00505293551491819}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1300.pth
epoch 1, batch 1400, avg loss 0.028286477867513895, metrics {'correct': 181, 'n_samples': 41560, 'accuracy': 0.004355149181905679}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1400.pth
epoch 1, batch 1500, avg loss 0.0272333662211895, metrics {'correct': 191, 'n_samples': 41560, 'accuracy': 0.004595765158806545}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1500.pth
epoch 1, batch 1600, avg loss 0.026026367507874966, metrics {'correct': 167, 'n_samples': 41560, 'accuracy': 0.0040182868142444655}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1600.pth
epoch 1, batch 1700, avg loss 0.025533549059182405, metrics {'correct': 184, 'n_samples': 41560, 'accuracy': 0.004427333974975939}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1700.pth
epoch 1, batch 1800, avg loss 0.023671794794499875, metrics {'correct': 189, 'n_samples': 41560, 'accuracy': 0.0045476419634263715}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1800.pth
epoch 1, batch 1900, avg loss 0.02321760853752494, metrics {'correct': 158, 'n_samples': 41560, 'accuracy': 0.003801732435033686}
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_1-1900.pth
Saving model to outputs/src/ae/experiment/TEST_get_labelchr22_excerpt_800kAutoencoder3x6d0.0n0.2l0.0_4at0.1_2-988.pth
Runtime:  45.332740610989276
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': False}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Runtime:  4.0479501860099845
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Config values:
{'name': 'TEST_get_label_multilayer', 'model': 'MultilayerAutoencoder', 'kernel_len': 9, 'latent_len': 200, 'seq_len': 64, 'seq_per_batch': 100, 'input_path': 'data/ref_genome/chr22_excerpt_800k.fa', 'split_prop': 0.05, 'epochs': 1, 'learn_rate': 0.1, 'input_dropout_freq': 0.05, 'latent_noise_std': 0.2, 'save_model': True, 'disable_eval': True, 'neighbour_loss_prop': 0.0, 'load_prev_model_state': None, 'hidden_len': 24, 'pool_size': 4, 'n_conv_and_pool': 2, 'n_conv_before_pool': 2, 'n_linear': 2, 'use_cuda_if_available': True, 'hidden_dropout_freq': 0.05, 'fixed_random_seed': True, 'n_dataloader_workers': 4, 'checkpoint_interval': 10000, 'output_len': 919, 'TEST_use_old_dataset': False, 'TEST_get_as_onehot': False, 'TEST_get_label': True}
reading sequence from file...
Model specification:
Autoencoder(
  (loss_fn): NeighbourDistanceLoss(
    (bce_loss): BCELoss()
    (mse_loss): MSELoss()
  )
  (encode_layers): ModuleDict(
    (input_dropout): SeqDropout(
      (dropout): Dropout2d(p=0.05, inplace=False)
    )
    (conv0): Conv1d(4, 200, kernel_size=(9,), stride=(1,))
    (relu0): ReLU()
  )
  (decode_layers): ModuleDict(
    (latent_noise): GaussianNoise()
    (conv0): ConvTranspose1d(200, 4, kernel_size=(9,), stride=(1,))
    (softmax): Softmax(dim=1)
  )
)
Loading data...
Split training and validation sets...
Create data loaders...
Training for 1 epochs
Using device:
cuda
Saving model to outputs/src/ae/experiment/TEST_get_label_multilayerchr22_excerpt_800kMultilayerAutoencoder9x200d0.05n0.2l0.0_2at0.1_1-134.pth
Runtime:  4.3756673479801975

real	6m20.889s
user	12m25.614s
sys	2m44.470s
